<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Scripts · TavaresSonoraPantanoMartinez2026</title><meta name="title" content="Scripts · TavaresSonoraPantanoMartinez2026"/><meta property="og:title" content="Scripts · TavaresSonoraPantanoMartinez2026"/><meta property="twitter:title" content="Scripts · TavaresSonoraPantanoMartinez2026"/><meta name="description" content="Documentation for TavaresSonoraPantanoMartinez2026."/><meta property="og:description" content="Documentation for TavaresSonoraPantanoMartinez2026."/><meta property="twitter:description" content="Documentation for TavaresSonoraPantanoMartinez2026."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TavaresSonoraPantanoMartinez2026 logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TavaresSonoraPantanoMartinez2026</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../figures/">Supplementary Figures</a></li><li class="is-active"><a class="tocitem" href>Scripts</a><ul class="internal"><li><a class="tocitem" href="#Recommended-Workflow-for-Reproducibility"><span>Recommended Workflow for Reproducibility</span></a></li><li><a class="tocitem" href="#Analyses"><span>Analyses</span></a></li><li><a class="tocitem" href="#Coordination-Number-of-Groups-(K,-M,-and-O)-and-Sodium-Ions"><span>Coordination Number of Groups (K, M, and O) and Sodium Ions</span></a></li><li><a class="tocitem" href="#Residue-Contributions-of-chain-K"><span>Residue Contributions of chain K</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Scripts</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Scripts</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tcvmilvv/TavaresSonoraPantanoMartinez2026.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tcvmilvv/TavaresSonoraPantanoMartinez2026.jl/blob/main/docs/src/scripts.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Scripts"><a class="docs-heading-anchor" href="#Scripts">Scripts</a><a id="Scripts-1"></a><a class="docs-heading-anchor-permalink" href="#Scripts" title="Permalink"></a></h1><p>This section contains example scripts designed to demonstrate how to perform the analyses and process the molecular dynamics data described in this work. These scripts serve as templates, allowing users to reproduce the results and customize inputs to suit their specific analysis needs. Each script is organized and annotated for clarity, ensuring ease of use and reproducibility. </p><h2 id="Recommended-Workflow-for-Reproducibility"><a class="docs-heading-anchor" href="#Recommended-Workflow-for-Reproducibility">Recommended Workflow for Reproducibility</a><a id="Recommended-Workflow-for-Reproducibility-1"></a><a class="docs-heading-anchor-permalink" href="#Recommended-Workflow-for-Reproducibility" title="Permalink"></a></h2><p>A step-by-step workflow designed to ensure reproducibility in the molecular dynamics analysis is demonstrated here. Follow the steps below to reproduce the analysis and modify them as needed for your specific datasets or research goals. </p><pre><code class="language-julia hljs">#
# Package environment and installation:
#
import Pkg
Pkg.update()
# Create and/or activate environment
Pkg.activate(&quot;ZIKASolvents&quot;; shared=true) 
# Install packages with the versions used in these analyses:
Pkg.add(name=&quot;ComplexMixtures&quot;, version=&quot;2.14&quot;)
Pkg.add(name=&quot;LaTeXStrings&quot;, version=&quot;1.4&quot;)
Pkg.add(name=&quot;PDBTools&quot;, version=&quot;3.6&quot;)
Pkg.add(name=&quot;Plots&quot;, version=&quot;1.41&quot;)

# Load required packages
using ComplexMixtures
using PDBTools
using Plots
using LaTeXStrings

# Define custom elements and residues for CG simulations with SIRAH
custom_elements!(SIRAH)
custom_protein_residues!(SIRAH)

# Load the PDB file
ats = readPDB(&quot;zikv_structure.pdb&quot;)</code></pre><h2 id="Analyses"><a class="docs-heading-anchor" href="#Analyses">Analyses</a><a id="Analyses-1"></a><a class="docs-heading-anchor-permalink" href="#Analyses" title="Permalink"></a></h2><p>Coordination Number of Chains K, M, and O and the WT4 Water Molecules</p><p>Example script for calculating the coordination number of chains K, M, and O with respect to the WT4 water molecules in a coarse-grained molecular dynamics simulation.</p><pre><code class="language-julia hljs"># Step 1: Define the solute, solute groups and solvent selections
solute = AtomSelection(select(ats, &quot;chain K or chain M or chain O&quot;),
    nmols = 1
    )

solvent = AtomSelection(select(ats, &quot;resname WT4&quot;), 
    natomspermol=4)

# Step 2: Load the trajectory file
trajectory = Trajectory(
    &quot;./trajectory.xtc&quot;,
    solute,
    solvent
    )

# Step 3: Set options for coordination number calculation
options = Options(bulk_range=(8.0, 12.0))

# Step 4: Calculate the coordination number
r = coordination_number(trajectory, options)

# Step 5: Save the results as a JSON file
save(&quot;./kmo_wt4.json&quot;, r)</code></pre><h2 id="Coordination-Number-of-Groups-(K,-M,-and-O)-and-Sodium-Ions"><a class="docs-heading-anchor" href="#Coordination-Number-of-Groups-(K,-M,-and-O)-and-Sodium-Ions">Coordination Number of Groups (K, M, and O) and Sodium Ions</a><a id="Coordination-Number-of-Groups-(K,-M,-and-O)-and-Sodium-Ions-1"></a><a class="docs-heading-anchor-permalink" href="#Coordination-Number-of-Groups-(K,-M,-and-O)-and-Sodium-Ions" title="Permalink"></a></h2><p>Example script for calculating the coordination number of chains K, M, and O divided into groups with respect to the solvent (sodium ions) in a coarse-grained molecular dynamics simulation.</p><pre><code class="language-julia hljs"># Step 1: Define the solute, solute groups and solvent selections
protein = select(ats, &quot;chain K or chain M or chain O&quot;)

solute = AtomSelection(protein,
    nmols = 1,
    group_atom_indices = [
        findall(Select(&quot;chain K&quot;), ats),
        findall(Select(&quot;chain M&quot;), ats),
        findall(Select(&quot;chain O&quot;), ats),
    ],
    group_names = [ &quot;K&quot;, &quot;M&quot;, &quot;O&quot; ]
  )
solvent = AtomSelection(select(ats, &quot;resname NaW&quot;), 
    natomspermol=4)

# Step 2: Load the trajectory file
trajectory = Trajectory(
    &quot;./trajectory.xtc&quot;,
    solute,
    solvent
)

# Step 3: Set options for coordination number calculation
options = Options(bulk_range=(8.0, 12.0))

# Step 4: Calculate the coordination number
r = coordination_number(trajectory, options)

# Step 5: Save the results as a JSON file
save(&quot;./kmo_groups_naw.json&quot;, r)</code></pre><h2 id="Residue-Contributions-of-chain-K"><a class="docs-heading-anchor" href="#Residue-Contributions-of-chain-K">Residue Contributions of chain K</a><a id="Residue-Contributions-of-chain-K-1"></a><a class="docs-heading-anchor-permalink" href="#Residue-Contributions-of-chain-K" title="Permalink"></a></h2><p>Example script for calculating the residue contributions of chains K with respect to the WT4 water molecules in a coarse-grained molecular dynamics simulation.</p><pre><code class="language-julia hljs"># Step 1: Load the Coordination Number JSON file
r = load(&quot;./kmo_wt4.json&quot;)

# Step 2: Select residues from chain K, segment S1
chaink = select(ats, &quot;chain K and segname S1&quot;)

# Step 3: Calculate the initial residue contributions for segment S1
rc = ResidueContributions(r, chaink; dmin=3, dmax=8, type=:coordination_number)

# Step 4: Loop through segments S2 to S60 and compute total residue contributions
for iseg in 2:60
    # Select residues for the current chain
    chain_selection = select(ats, &quot;chain K and segname S$iseg&quot;)
    
    # Calculate the residue contributions for the current chain
    rc_i = ResidueContributions(r, chain_selection; dmin=3, dmax=8, type=:coordination_number)
    
    # Sum up the contributions
    rc += rc_i
end

# Step 5: Average the residue contributions over all chains K
rc = rc/60

# Step 6: Save the contributions per residue as a JSON file
save(&quot;./rc_k_wt4&quot;, rc)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../figures/">« Supplementary Figures</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 3 February 2026 12:44">Tuesday 3 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
